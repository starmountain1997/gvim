-- =============================================================================
-- === nvim-tree.lua 配置 ===
-- =============================================================================
-- nvim-tree 是 Neovim 的文件浏览器插件
-- 简化配置：只需要 F1 键折叠/打开文件树

local function on_attach(bufnr)
  local api = require("nvim-tree.api")

  -- 应用默认键位映射（保留基本功能）
  api.config.mappings.default_on_attach(bufnr)

  -- 不需要自定义映射，使用全局 F1 键即可
end

-- =============================================================================
-- === 主配置 ===
-- =============================================================================
require("nvim-tree").setup({
  -- =========================================================================
  -- === 过滤配置 ===
  -- =========================================================================
  filters = {
    -- 默认显示点文件
    dotfiles = true,
    -- 排除列表：隐藏开发环境中的临时文件、缓存文件和配置目录
    exclude = {
      -- Python 相关
      "__pycache__",
      ".ruff_cache",
      "%.egg-info",  -- Python 包信息目录

      -- 版本控制
      ".git",

      -- 开发工具和缓存
      ".claude",
      ".DS_Store",  -- macOS 系统文件
      "Session.vim",  -- Vim 会话文件

      -- Vim/Neovim 临时文件
      "%.swp",
      "%.swo",
      "%.swn",

      -- Python 开发工具
      "uv.lock",  -- uv 包管理器锁文件
      "pytest.ini",  -- pytest 配置文件
      ".pytest_cache",  -- pytest 缓存

      -- IDE 配置
      ".idea",  -- JetBrains IDE 配置

      -- 其他
      "node_modules",
      ".cache",
    },
    -- 自定义过滤函数
    custom = {},
  },

  -- =========================================================================
  -- === 排序配置 ===
  -- =========================================================================
  sort = {
    sorter = "name",  -- 按名称排序
    folders_first = true,  -- 文件夹优先
  },

  -- =========================================================================
  -- === Git 集成 ===
  -- =========================================================================
  git = {
    enable = true,  -- 启用 Git 状态显示
    ignore = true,  -- 忽略 .gitignore 中的文件
    timeout = 400,  -- Git 命令超时时间（毫秒）
  },

  -- =========================================================================
  -- === 其他配置 ===
  -- =========================================================================
  -- 自定义键位映射
  on_attach = on_attach,
})


-- =============================================================================
-- === 全局键位映射 ===
-- =============================================================================
-- 设置全局快捷键：F1 键折叠/打开文件树

vim.keymap.set("n", "<F1>", "<cmd>NvimTreeToggle<CR>", { desc = "折叠/打开文件树" })


